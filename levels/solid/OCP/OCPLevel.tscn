[gd_scene load_steps=24 format=2]

[ext_resource path="res://levels/solid/OCP/OCPLevel.gd" type="Script" id=1]
[ext_resource path="res://entities/map/Map.tscn" type="PackedScene" id=2]
[ext_resource path="res://entities/doors/DoorSingle.tscn" type="PackedScene" id=3]
[ext_resource path="res://entities/level/PlayerSpawner.gd" type="Script" id=4]
[ext_resource path="res://levels/solid/OCP/info.tres" type="Resource" id=5]
[ext_resource path="res://levels/solid/OCP/slides/Slide.tscn" type="PackedScene" id=6]
[ext_resource path="res://entities/computer/Computer.tscn" type="PackedScene" id=7]
[ext_resource path="res://entities/Hint/Hint.tscn" type="PackedScene" id=8]
[ext_resource path="res://entities/slider/Slider.tscn" type="PackedScene" id=9]
[ext_resource path="res://entities/doors/Door.tscn" type="PackedScene" id=10]
[ext_resource path="res://entities/screen/WideScreen.tscn" type="PackedScene" id=11]
[ext_resource path="res://entities/Item.tscn" type="PackedScene" id=12]
[ext_resource path="res://entities/constraints/ComplexityConstraint.tscn" type="PackedScene" id=13]
[ext_resource path="res://entities/button/ButtonItem.tscn" type="PackedScene" id=14]
[ext_resource path="res://levels/solid/OCP/slides/Slide1.tscn" type="PackedScene" id=15]
[ext_resource path="res://levels/solid/OCP/lightmap/lightmap.lmbake" type="BakedLightmapData" id=22]

[sub_resource type="GDScript" id=5]
script/source = "extends Door
"

[sub_resource type="GDScript" id=4]
script/source = "extends Screen

"

[sub_resource type="GDScript" id=1]
script/source = "extends Screen

var PasswordSetter=getObject(\"PasswordSetter\")
func subscribe():
	PasswordSetter.addScreen(self)

"

[sub_resource type="GDScript" id=2]
script/source = "extends Screen
"

[sub_resource type="GDScript" id=3]
script/source = "extends Screen
"

[sub_resource type="GDScript" id=6]
script/source = "extends Code

#You will not need to call these screens here
var screen1 = getObject(\"Screen1\")
var screen2 = getObject(\"Screen2\")
var screen3 = getObject(\"Screen3\")
var screen4 = getObject(\"Screen4\")

var password =\"\"

#This will help you in the solution
#use array_name.append(object) to add an object in the array
var screens : Array
func addScreen(screen:Screen):

	pass

#We need to make this function more general to accept any number of screens
#you can use \"for i in array.size():\" and \"array[i]\" to get access to elements
func findPassword() -> String:
	if screen1.getValue()!=\"000\":
		password=password+screen1.getValue()
	if screen2.getValue()!=\"000\":
		password=password+screen2.getValue()
	#... if we continue the same way the complexity will be increased
	#(a lot of conditions)
	#Use only one condition inside a for loop 
	return password
"

[sub_resource type="GDScript" id=7]
script/source = "extends WallButton

var door= getObject(\"Door\")
var PasswordSetter=getObject(\"PasswordSetter\")



func onButtonPressed():

	PasswordSetter.addScreen(getObject(\"Screen1\"))
	PasswordSetter.addScreen(getObject(\"Screen2\"))
	PasswordSetter.addScreen(getObject(\"Screen3\"))
	PasswordSetter.addScreen(getObject(\"Screen4\"))
	
	door.open(PasswordSetter.findPassword())

"

[node name="OCPLevel" type="Spatial"]
script = ExtResource( 1 )
level_info = ExtResource( 5 )
slider = NodePath("Slider")
map = NodePath("Map")
spawner = NodePath("PlayerSpawner")
hints = NodePath("Hints")

[node name="Slider" parent="." instance=ExtResource( 9 )]
slide_scenes = [ ExtResource( 6 ) ]

[node name="Hints" parent="." instance=ExtResource( 8 )]
slide_scenes = [ ExtResource( 6 ), ExtResource( 15 ) ]

[node name="Map" parent="." instance=ExtResource( 2 )]
data = {
"cells": PoolIntArray( 1, 0, -1609170942, 65535, 0, -1610612734, 262145, 0, -1610481639, 327679, 0, -1610481639, 65535, 2, -1610612733, 262145, 2, -1610481639, 327679, 2, -1610481639, 2, 3, -1609170930, 65534, 3, -1609564146, 65535, 4, -1610612733, 262145, 4, -1610481639, 327679, 4, -1610481639, 65535, 6, -1610612733, 262145, 6, -1610481639, 327679, 6, -1610481639, 2, 7, -1609170935, 65534, 7, -1609564151, 1, 8, -1609957374, 65535, 8, -1609564158, 262145, 8, -1610481642, 327679, 8, -1610481642, 0, 9, -1609957339, 2, 9, -1610612705, 65534, 9, -1610612705, -131072, 65483, -1610612699, -131070, 65483, -1610612705, -65538, 65483, -1610612705, 131073, 65484, -1609433063, 196607, 65484, -1609433063, -131071, 65484, -1609170942, -65537, 65484, -1610612734, -131070, 65485, -1609170935, -65538, 65485, -1609564151, 131073, 65486, -1609433063, 196607, 65486, -1609433063, -131071, 65486, -1609957373, 131073, 65488, -1609433063, 196607, 65488, -1609433063, -131071, 65488, -1609957373, -131070, 65489, -1609170935, -65538, 65489, -1609564151, 131073, 65490, -1609433063, 196607, 65490, -1609433063, -131071, 65490, -1609957374, -65537, 65490, -1609564158, -131072, 65491, -1609957341, -131070, 65491, -1610612705, -65538, 65491, -1610612705, -131072, 65493, -1610612700, -131068, 65493, -1610612729, -131064, 65493, -1610612729, -131060, 65493, -1610612729, -131058, 65493, -1610612705, -65550, 65493, -1610612705, -65548, 65493, -1610612729, -65544, 65493, -1610612729, -65540, 65493, -1610612729, 131073, 65494, -1610088423, 131075, 65494, -1610088423, 131077, 65494, -1610088423, 131079, 65494, -1610088423, 131081, 65494, -1610088423, 131083, 65494, -1610088423, 131085, 65494, -1609301995, 196595, 65494, -1610088427, 196597, 65494, -1610088423, 196599, 65494, -1610088423, 196601, 65494, -1610088423, 196603, 65494, -1610088423, 196605, 65494, -1610088423, 196607, 65494, -1610088423, -131071, 65494, -1609170939, -131069, 65494, -1609170939, -131067, 65494, -1609170939, -131065, 65494, -1609170939, -131063, 65494, -1609170939, -131061, 65494, -1609170942, -131059, 65494, -1610612731, -65549, 65494, -1609957371, -65547, 65494, -1610612734, -65545, 65494, -1609170939, -65543, 65494, -1609170939, -65541, 65494, -1609170939, -65539, 65494, -1609170939, -65537, 65494, -1609170939, -131058, 65495, -1609170930, -65550, 65495, -1609564146, 131073, 65496, -1610088423, 131075, 65496, -1610088423, 131077, 65496, -1610088423, 131079, 65496, -1610088423, 131081, 65496, -1610088423, 131083, 65496, -1610088423, 131085, 65496, -1610088423, 196595, 65496, -1610088423, 196597, 65496, -1610088423, 196599, 65496, -1610088423, 196601, 65496, -1610088423, 196603, 65496, -1610088423, 196605, 65496, -1610088423, 196607, 65496, -1610088423, -131071, 65496, -1609564159, -131069, 65496, -1609564159, -131067, 65496, -1609564159, -131065, 65496, -1609564159, -131063, 65496, -1609564159, -131061, 65496, -1609957371, -131059, 65496, -1610612731, -65549, 65496, -1609957371, -65547, 65496, -1610612731, -65545, 65496, -1609564159, -65543, 65496, -1609564159, -65541, 65496, -1609564159, -65539, 65496, -1609564159, -65537, 65496, -1609564159, 131073, 65498, -1610088423, 131075, 65498, -1610088423, 131077, 65498, -1610088423, 131079, 65498, -1610088423, 131081, 65498, -1610088425, 131083, 65498, -1610088423, 131085, 65498, -1610088423, 196595, 65498, -1610088423, 196597, 65498, -1610088423, 196599, 65498, -1610088425, 196601, 65498, -1610088423, 196603, 65498, -1610088423, 196605, 65498, -1610088423, 196607, 65498, -1610088423, -131071, 65498, -1609564159, -131069, 65498, -1609564159, -131067, 65498, -1609564159, -131065, 65498, -1609564159, -131063, 65498, -1609564159, -131061, 65498, -1609957371, -131059, 65498, -1610612731, -65549, 65498, -1609957371, -65547, 65498, -1610612731, -65545, 65498, -1609564159, -65543, 65498, -1609564159, -65541, 65498, -1609564159, -65539, 65498, -1609564159, -65537, 65498, -1609564159, -131068, 65499, -1610612705, -131058, 65499, -1609170930, -65550, 65499, -1609564146, -65540, 65499, -1610612705, 131073, 65500, -1609433068, 131075, 65500, -1609433068, 131077, 65500, -1610088423, 131079, 65500, -1610088423, 131081, 65500, -1610088425, 131083, 65500, -1610088423, 131085, 65500, -1610088423, 196595, 65500, -1610088423, 196597, 65500, -1610088423, 196599, 65500, -1610088425, 196601, 65500, -1610088423, 196603, 65500, -1610088423, 196605, 65500, -1609433068, 196607, 65500, -1609433068, -131071, 65500, -1609564156, -131069, 65500, -1609564156, -131067, 65500, -1609564131, -131065, 65500, -1609564159, -131063, 65500, -1609564159, -131061, 65500, -1609957371, -131059, 65500, -1610612731, -65549, 65500, -1609957371, -65547, 65500, -1610612731, -65545, 65500, -1609564159, -65543, 65500, -1609564159, -65541, 65500, -1609564131, -65539, 65500, -1609564156, -65537, 65500, -1609564156, 131073, 65502, -1609433068, 131075, 65502, -1609433068, 131077, 65502, -1610088423, 131079, 65502, -1610088423, 131081, 65502, -1610088425, 131083, 65502, -1610088423, 131085, 65502, -1610088423, 196595, 65502, -1610088423, 196597, 65502, -1610088423, 196599, 65502, -1610088425, 196601, 65502, -1610088423, 196603, 65502, -1610088423, 196605, 65502, -1609433068, 196607, 65502, -1609433068, -131071, 65502, -1609564156, -131069, 65502, -1609564156, -131067, 65502, -1609564131, -131065, 65502, -1609564159, -131063, 65502, -1609564159, -131061, 65502, -1609957371, -131059, 65502, -1610612731, -65549, 65502, -1609957371, -65547, 65502, -1610612731, -65545, 65502, -1609564159, -65543, 65502, -1609564159, -65541, 65502, -1609564131, -65539, 65502, -1609564156, -65537, 65502, -1609564156, -131058, 65503, -1609170930, -65550, 65503, -1609564146, 131073, 65504, -1609433068, 131075, 65504, -1609433068, 131077, 65504, -1610088423, 131079, 65504, -1610088423, 131081, 65504, -1610088425, 131083, 65504, -1610088423, 131085, 65504, -1610088423, 196595, 65504, -1610088423, 196597, 65504, -1610088423, 196599, 65504, -1610088425, 196601, 65504, -1610088423, 196603, 65504, -1610088423, 196605, 65504, -1609433068, 196607, 65504, -1609433068, -131071, 65504, -1609564156, -131069, 65504, -1609564156, -131067, 65504, -1609564131, -131065, 65504, -1609564159, -131063, 65504, -1609564159, -131061, 65504, -1609957371, -131059, 65504, -1610612731, -65549, 65504, -1609957371, -65547, 65504, -1610612731, -65545, 65504, -1609564159, -65543, 65504, -1609564159, -65541, 65504, -1609564131, -65539, 65504, -1609564156, -65537, 65504, -1609564156, 131073, 65506, -1609433068, 131075, 65506, -1609433068, 131077, 65506, -1610088423, 131079, 65506, -1610088423, 131081, 65506, -1610088425, 131083, 65506, -1610088423, 131085, 65506, -1610088423, 196595, 65506, -1610088423, 196597, 65506, -1610088423, 196599, 65506, -1610088425, 196601, 65506, -1610088423, 196603, 65506, -1610088423, 196605, 65506, -1609433068, 196607, 65506, -1609433068, -131071, 65506, -1609564156, -131069, 65506, -1609564156, -131067, 65506, -1609564131, -131065, 65506, -1609564159, -131063, 65506, -1609564159, -131061, 65506, -1609957371, -131059, 65506, -1610612731, -65549, 65506, -1609957371, -65547, 65506, -1610612731, -65545, 65506, -1609564159, -65543, 65506, -1609564159, -65541, 65506, -1609564131, -65539, 65506, -1609564156, -65537, 65506, -1609564156, -131068, 65507, -1610612705, -131058, 65507, -1609170930, -65550, 65507, -1609564146, -65540, 65507, -1610612705, 131073, 65508, -1610088423, 131075, 65508, -1610088423, 131077, 65508, -1610088423, 131079, 65508, -1610088423, 131081, 65508, -1610088425, 131083, 65508, -1610088423, 131085, 65508, -1610088423, 196595, 65508, -1610088423, 196597, 65508, -1610088423, 196599, 65508, -1610088425, 196601, 65508, -1610088423, 196603, 65508, -1610088423, 196605, 65508, -1610088423, 196607, 65508, -1610088423, -131071, 65508, -1609564159, -131069, 65508, -1609564159, -131067, 65508, -1609564159, -131065, 65508, -1609564159, -131063, 65508, -1609564159, -131061, 65508, -1609957371, -131059, 65508, -1610612731, -65549, 65508, -1609957371, -65547, 65508, -1610612731, -65545, 65508, -1609564159, -65543, 65508, -1609564159, -65541, 65508, -1609564159, -65539, 65508, -1609564159, -65537, 65508, -1609564159, 131073, 65510, -1610088423, 131075, 65510, -1610088423, 131077, 65510, -1610088423, 131079, 65510, -1610088423, 131081, 65510, -1610088423, 131083, 65510, -1610088423, 131085, 65510, -1610088423, 196595, 65510, -1610088423, 196597, 65510, -1610088423, 196599, 65510, -1610088423, 196601, 65510, -1610088423, 196603, 65510, -1610088423, 196605, 65510, -1610088423, 196607, 65510, -1610088423, -131071, 65510, -1609564159, -131069, 65510, -1609564159, -131067, 65510, -1609564159, -131065, 65510, -1609564159, -131063, 65510, -1609564159, -131061, 65510, -1609957371, -131059, 65510, -1610612731, -65549, 65510, -1609957371, -65547, 65510, -1610612731, -65545, 65510, -1609564159, -65543, 65510, -1609564159, -65541, 65510, -1609564159, -65539, 65510, -1609564159, -65537, 65510, -1609564159, -131058, 65511, -1609170930, -65550, 65511, -1609564146, 131073, 65512, -1610088423, 131075, 65512, -1610088423, 131077, 65512, -1610088423, 131079, 65512, -1610088423, 131081, 65512, -1610088423, 131083, 65512, -1610088423, 131085, 65512, -1609433067, 196595, 65512, -1609433067, 196597, 65512, -1609433063, 196599, 65512, -1610088423, 196601, 65512, -1610088423, 196603, 65512, -1610088423, 196605, 65512, -1610088423, 196607, 65512, -1610088423, -131071, 65512, -1609957370, -131069, 65512, -1609564155, -131067, 65512, -1609564155, -131065, 65512, -1609564155, -131063, 65512, -1609564155, -131061, 65512, -1609957374, -131059, 65512, -1610612731, -65549, 65512, -1609957371, -65547, 65512, -1609564158, -65545, 65512, -1609564155, -65543, 65512, -1609564155, -65541, 65512, -1609564155, -65539, 65512, -1609564155, -65537, 65512, -1609564154, -131070, 65513, -1610612705, -131068, 65513, -1609957362, -131064, 65513, -1609957362, -131060, 65513, -1609957362, -131058, 65513, -1610612705, -65550, 65513, -1610612705, -65548, 65513, -1609957362, -65544, 65513, -1609957362, -65540, 65513, -1609957362, -65538, 65513, -1610612705, 131073, 65514, -1610088423, 196607, 65514, -1610088423, -65537, 65514, -1610612733, -131070, 65515, -1609170930, -65538, 65515, -1609564146, 131073, 65516, -1610088423, 196607, 65516, -1610088423, 196609, 65517, -1610088423, 262143, 65517, -1610088423, -131070, 65517, -1610612706, -65538, 65517, -1610612706, -65536, 65517, -1610612701, -65536, 65518, -1609957360, 196609, 65519, -1610088423, 262143, 65519, -1610088423, -65534, 65519, -1609170930, -2, 65519, -1609564146, 0, 65521, -1609957360, 196609, 65521, -1610088423, 262143, 65521, -1610088423, 262146, 65521, -1609498594, -65534, 65521, -1609170913, -2, 65521, -1609170913, 0, 65522, -1610612702, 262145, 65522, -1610481639, 327679, 65522, -1610481639, 2, 65523, -1609170930, 65534, 65523, -1609564146, 65536, 65524, -1609957360, 262145, 65524, -1610481639, 327679, 65524, -1610481639, 131071, 65525, -1610612733, 262145, 65526, -1610481639, 327679, 65526, -1610481639, 2, 65527, -1609170930, 65534, 65527, -1609564146, 131071, 65527, -1610612733, 262145, 65528, -1610481639, 327679, 65528, -1610481639, 131071, 65529, -1610612733, 262145, 65530, -1610481639, 327679, 65530, -1610481639, 2, 65531, -1609170930, 65534, 65531, -1609564146, 131071, 65531, -1610612733, 65536, 65532, -1610612720, 262145, 65532, -1610481639, 327679, 65532, -1610481639, 262145, 65534, -1610481639, 327679, 65534, -1610481639, 2, 65535, -1609170930, 65534, 65535, -1609564146 )
}

[node name="PlayerSpawner" type="Position3D" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.478787, 1.45278, 6.21731 )
script = ExtResource( 4 )

[node name="BakedLightmap" type="BakedLightmap" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.25098, -16.7899 )
extents = Vector3( 16.0524, 6.28859, 37.6049 )
capture_quality = 0
light_data = ExtResource( 22 )

[node name="OmniLight" type="OmniLight" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.67865, 3.04695, -6.12529 )
light_energy = 0.5
omni_range = 5.91486

[node name="OmniLight4" type="OmniLight" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.67865, 0.990132, -19.1432 )
light_energy = 0.744
omni_range = 6.36972

[node name="OmniLight2" type="OmniLight" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.412033, 1.0725, -49.4653 )
light_energy = 0.5
omni_range = 49.6241

[node name="OmniLight6" type="OmniLight" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.412033, 1.51139, -29.0094 )
light_energy = 1.045
omni_range = 20.9293

[node name="OmniLight3" type="OmniLight" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.418998, 2.26872, 4.19321 )
light_energy = 0.678
omni_range = 12.7078

[node name="DoorSingle2" parent="." instance=ExtResource( 3 )]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0.465099, 0.574933, 9.39461 )

[node name="Computer" parent="." instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.441729, -1.48539, -33.2024 )

[node name="Door" parent="." instance=ExtResource( 10 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.474108, -1.45129, -42.2479 )
code = SubResource( 5 )
display_name = "Door"
is_programmable = true
locked = true

[node name="DoorSingle" parent="." instance=ExtResource( 3 )]
transform = Transform( -4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0.546838, -1.45117, -52.8196 )
is_interactable = true

[node name="ScreenItem" parent="." instance=ExtResource( 11 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.34374, 1.31544, -42.7582 )
code = SubResource( 4 )
display_name = "Screen1"
description = "Value 1"
is_programmable = true
locked = true

[node name="ScreenItem2" parent="." instance=ExtResource( 11 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.35893, 0.897665, -42.7394 )
code = SubResource( 1 )
display_name = "Screen2"
description = "Value 2"
is_programmable = true
locked = true

[node name="ScreenItem3" parent="." instance=ExtResource( 11 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.35893, 0.474055, -42.7394 )
code = SubResource( 2 )
display_name = "Screen3"
description = "Value 3"
is_programmable = true
locked = true

[node name="ScreenItem4" parent="." instance=ExtResource( 11 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.35893, 0.0384985, -42.7394 )
code = SubResource( 3 )
display_name = "Screen4"
description = "Value 4"
is_programmable = true
locked = true

[node name="Item" parent="." instance=ExtResource( 12 )]
code = SubResource( 6 )
display_name = "PasswordSetter"
is_programmable = true
starting_script = "extends Code

var screen1 = getObject(\"Screen1\")
var screen2 = getObject(\"Screen2\")
var screen3 = getObject(\"Screen3\")
var screen4 = getObject(\"Screen4\")
var password =\"\"

#This will help you in the solution
var screens=[]
func addScreen(screen):
	screens.append(screen)


#We need to make this function more general while reducing its complexity 
func findPassword() -> String:
	if screen1.getValue()!=\"000\":
		password=password+screen1.getValue()
	if screen2.getValue()!=\"000\":
		password=password+screen2.getValue()
	
	return password
"

[node name="ExpressionChanger" type="Timer" parent="."]
wait_time = 4.0
autostart = true

[node name="PasswordChecker" type="Timer" parent="."]
autostart = true

[node name="cycLimitConstraint" parent="." instance=ExtResource( 13 )]
cyc_limit = 5

[node name="Button" parent="." instance=ExtResource( 14 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 2.44172, 0.182099, -42.5819 )
code = SubResource( 7 )
display_name = "Button"
is_programmable = true
connect_pressed = true

[node name="HintsTimer" type="Timer" parent="."]
wait_time = 300.0
one_shot = true
autostart = true

[connection signal="interact" from="DoorSingle" to="." method="_on_DoorSingle_interact"]
[connection signal="timeout" from="ExpressionChanger" to="." method="_on_ExpressionChanger_timeout"]
[connection signal="pressed" from="Button" to="." method="_on_Button_pressed"]
[connection signal="timeout" from="HintsTimer" to="." method="_on_HintsTimer_timeout"]
